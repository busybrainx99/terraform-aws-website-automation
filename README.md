# Terraform-Aws-Website-Automation
## Automate website hosting on AWS using Terraform with S3, CloudFront, Route 53, and ACM Certificate

## Created the project without modules first
### The first step was to run the project simply by not organizing it into modules. This approach allows for an easy transition to a modular structure once it's up and running smoothly.
### This was my original file structure
<img width="296" alt="EXPLORER" src="https://github.com/busybrainx99/terraform-aws-website-automation/assets/105159710/67b5a55b-ed2d-4f02-b33a-6b03fb91d85a">


## S3_Bucket
### aws_s3_bucket.static_website: Created an s3 bucket for hosting website. Created the resource with the force_destroy as true so that all the resources within the bucket get destroyed when terraform destroy is run.
### aws_s3_bucket_public_access_block.block_access: Blocked public access as I only wanted the bucket to be accessible from my cloud front
### aws_s3_object: Uploaded the website files: HTML, CSS, and JS. Initially, I tried using for_each to loop through my static website files, but it resulted in the files being downloaded instead of rendered, even after adding content_type = each.value. I decided to follow the more manual approach found in the documentation by specifying the website files individually. Later, I switched to a more automated approach while working with modules, and my site successfully loaded on the main domain name. It appears that both approaches can work effectively.
### Also didn't activate static website hosting on s3 as I wanted only the cloudfront to have access to the rendering the page.

## Cloudfront
### aws_cloudfront_distribution.static_cloudfront: Configured the CloudFront distribution, setting up origins, behaviors, and viewer certificate. I used most of the default settings from the documentation but also added some settings like enabling ipv4 and 6, running cloud front to redirect to HTTPS for viewers policy, and making sure there were no geo-restrictions.
### aws_cloudfront_origin_access_control.orgin_access: Created cloud front to access s3 bucket throught it's OAC.
### Used cloud front default certificate before changing it to use ACM certificate. The default certificate allowed me access the website via only cloudfront's domain name. Added the ACM certificate so I could use the external domain name.
### Assigning aliases to my domain name (var.domain_name) was crucial. This ensured that CloudFront used my domain name as a CNAME, thereby preventing any 403 errors associated with accessing the site.
### cloud front rendering 
<img width="721" alt="Screenshot 2024-06-28 at 15 14 42" src="https://github.com/busybrainx99/terraform-aws-website-automation/assets/105159710/976c7a07-5216-47df-9d27-b28c0f309d00">


## Permissions
### aws_s3_bucket_policy.static_website_policy: Sets the S3 bucket policy to allow CloudFront to access the bucket.

## Certificates
### aws_acm_certificate.acm_cer: Requested a certificate for the specified domain.
### aws_acm_certificate_validation.acm_valid: Validated the certificate using the DNS records.
### provider.aws: Set the AWS provider for the us-east-1 region, which is required for ACM. while I used ca-central-1 for my other resources.


## Updating AWS ACM Certificate Validation
### It's important to note that during the initial terraform apply, the process may get stuck on AWS ACM certificate validation. If this occurs:
<img width="754" alt="Screenshot 2024-06-28 at 19 10 45" src="https://github.com/busybrainx99/terraform-aws-website-automation/assets/105159710/6f6d0ef2-712e-4fb2-a61d-9797d78f0f49">
### Halt Terraform Operation: Pause the terraform apply process.
#### Update Name Servers: Visit your domain registrar's DNS settings and input the name servers generated by AWS Route 53. This action connects the AWS name servers with your domain name globally.
<img width="911" alt="Screenshot 2024-06-28 at 19 11 43" src="https://github.com/busybrainx99/terraform-aws-website-automation/assets/105159710/2aa9fc62-6703-44ce-99ef-b9fb76796b99">

<img width="1300" alt="Screenshot 2024-06-28 at 19 11 13" src="https://github.com/busybrainx99/terraform-aws-website-automation/assets/105159710/ce188828-8067-4cc5-8749-901305b12ac1">

### Resume terraform apply: Once the name servers have propagated globally, proceed with terraform apply again. This step ensures successful ACM certificate validation and alignment with your Terraform configuration.
### This approach guarantees that your ACM certificate validation completes effectively and maintains consistency across your infrastructure.

## Route53
### aws_route53_zone.main_route: Created a Route 53 hosted zone for the domain.
### aws_route53_record.www: Created an A record for the domain, pointing to the CloudFront distribution.
### aws_route53_record.alternate: Created an A record for the www subdomain, also pointing to the CloudFront distribution.
### aws_route53_record.cert_validation: Created DNS records for domain validation.

## Outputs
### output "cloudfront_domain_name" Output the CloudFront domain name


## main file (TO be updated)
### The main.tf file was used to call all the modules, including CloudFront, S3, permissions, certificate, and Route 53 modules.

## main variables file
### region The AWS region where resources are created.
### bucket_name: The name of the S3 bucket.
### domain_name: The domain name for the website.

## terraform.tfvars file
## region: Specified the primary region as ca-central-1.
## bucket_name: Set the bucket name to traffic-website.
## domain_name: Set the domain name to goodnesseboh.engineer.

## Outputs Screenshoot

## s3bucket
<img width="1234" alt="Screenshot 2024-06-28 at 19 19 06" src="https://github.com/busybrainx99/terraform-aws-website-automation/assets/105159710/c063e240-7e55-4b28-bb90-470070bf0f80">

## Cloudfront
<img width="984" alt="Screenshot 2024-06-28 at 19 33 21" src="https://github.com/busybrainx99/terraform-aws-website-automation/assets/105159710/45975369-1d34-4c7a-be18-d04dc23ff8db">

## Route53
<img width="1214" alt="Screenshot 2024-06-28 at 19 18 09" src="https://github.com/busybrainx99/terraform-aws-website-automation/assets/105159710/20f4f7ec-f486-4854-acef-8f442329a61d">

## Certificate manager
<img width="1007" alt="Screenshot 2024-06-28 at 19 21 09" src="https://github.com/busybrainx99/terraform-aws-website-automation/assets/105159710/619af1c2-a60f-46bd-9d61-95794b4fb379">

## Terraform outputs from terraform apply
<img width="1100" alt="Screenshot 2024-06-28 at 19 28 35" src="https://github.com/busybrainx99/terraform-aws-website-automation/assets/105159710/f02604ab-1f17-4a26-b8ac-03e5de1503f8">

## Domain Name website output
<img width="1440" alt="Screenshot 2024-06-28 at 19 31 21" src="https://github.com/busybrainx99/terraform-aws-website-automation/assets/105159710/35575dea-fa8a-4ff7-ac5b-e3fe6405bdef">

## Terraform outputs from terraform destroy
<img width="1015" alt="Screenshot 2024-06-28 at 19 52 51" src="https://github.com/busybrainx99/terraform-aws-website-automation/assets/105159710/2fc039f7-38f2-4d59-94f4-f97b2cfe1f5f">




